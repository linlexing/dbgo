<style type="text/css">

.navbar-header button{
	float:left;
}
.dropdown-menu > li > a > img {
	margin-right: 8px;
	vertical-align: -35%;
	width: 24px;
	padding-right: 0;
	margin-top: 0;
}
body
{
    padding-top: 50px;
}
/* Hide for mobile, show later */
.sidebar {
	display: none;
}
@media (min-width: 768px) {
  .sidebar {
    position: fixed;
    top: 51px;
    bottom: 0;
    left: 0;
    z-index: 1000;
    display: block;
    padding: 20px;
    overflow-x: hidden;
    overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
    background-color: #f5f5f5;
    border-right: 1px solid #eee;
  }
}
.leftContent{
	margin-top: -20px;
	margin-right: -20px;
	margin-left: -20px;
}
</style>
<script>
	function clearText(str){
		return str.replace(/[0-9]+\./g,"");
	}
	var Elements=<#.CurrentUserElement#>;
	var TopCategorys=[];
	var TopCategorysEn={};
	var TopCategorysZh_cn={};
	var i =0;
	for(item in Elements){
		i++;
		en = Elements[item].category_en.split("/")[0];
		cn = Elements[item].category_zh_cn.split("/")[0];
		var name ;
		if(en == ""){
			name =clearText(cn) ;
		}else{
			name = clearText(en) ;
		}
		TopCategorys.push({
			name:name,
			category_en:en,
			category_zh_cn:cn
		});
		TopCategorys = _.sortBy(TopCategorys,"category_en");
		TopCategorysEn[name] = clearText(en);
		TopCategorysZh_cn[name] = clearText(cn);
	}
	app.config(['$translateProvider', function ($translateProvider) {
		$translateProvider.translations('en', {
			"DEPT_LABEL":<#.c.Session.Get "_dept.label_en"#>,
			"PROJECT_LABEL": <#.c.Project.DisplayLabel.en#>,
			"LANGUAGE":"Language",
			"EN":"English",
			"ZH_CN":"Simplified Chinese",
			"TOP_CATEGORY":TopCategorysEn
		});

		$translateProvider.translations('zh_CN', {
			"DEPT_LABEL":<#.c.Session.Get "_dept.label_zh_cn"#>,
			"PROJECT_LABEL": <#.c.Project.DisplayLabel.zh_CN#>,
			"LANGUAGE":"语言",
			"EN":"英语",
			"ZH_CN":"简体中文",
			"TOP_CATEGORY":TopCategorysZh_cn
		});
		$translateProvider.determinePreferredLanguage();
	}]);
	app.controller('mainCtrl', ['$translate', '$scope','$rootScope','$location','$aside', function ($translate, $scope,$rootScope,$location,$aside) {
		var SetTitle=function (label) {
			document.title='<#.c.Project.Name#> - <#.c.Session.Get "_user.name"#> [<#.c.Session.Get "_dept.name"#> - ' + label +']';
		};
		$translate('DEPT_LABEL').then(SetTitle);
		$rootScope.$on('$translateChangeSuccess', function () {
			$translate('DEPT_LABEL').then(SetTitle);
		});
		$scope.changeLanguage = function (langKey) {
			$translate.use(langKey);
		};
		$scope.topMenus= TopCategorys;
		$scope.isTopActive = function (viewLocation) {
	        return _.str.startsWith($location.path(),viewLocation);
	    };
		$scope.navCollapsed = true;
		$scope.aside = {
  "title": "Title",
  "content": "Hello Aside<br />This is a multiline message!"
};
		var myOtherAside = $aside({
			scope: $scope,
			title:"select menu",
			animation:"am-slide-left",
			show:false,
			placement:"left",
			contentTemplate: 'left-sample.html'
		});
		$scope.topClick=function(category){
			if($rootScope.viewport=="xs"){
				$scope.navCollapsed = true;
				myOtherAside.$promise.then(function() {
    				myOtherAside.show();
  				})
			}
			$location.path("/"+category);
		};
	}]);
	app.run(function ($rootScope,$location) {
	    $rootScope.$on('$locationChangeSuccess', function () {
	        console.log('$locationChangeSuccess changed!', new Date(),$location.path());
	    });
		if($location.path()==""){
			$location.path("/"+ TopCategorys[0].name);
		}
	});
</script>
<div ng-controller="mainCtrl">
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" ng-click="navCollapsed = !navCollapsed">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<div class="navbar-brand navbar-left" ><i class="icon-home"></i> <span class="hidden-xs" translate>PROJECT_LABEL</span><span class="visible-xs-inline"><#.c.Project.Name#></span></div>
		</div>
		<div class="navbar-collapse collapse" ng-class="{'in':!navCollapsed}">
			<ul class="nav navbar-nav navbar-left">
				<li ng-repeat="item in topMenus" ng-class="{ active: isTopActive('/'+item.name)}" ng-click="topClick(item.name)">
					<a href="" translate>TOP_CATEGORY.{{item.name}}</a>
				</li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li class="hidden-xs">
					<a href="" data-animation="am-flip-x" bs-dropdown data-placement="bottom-right" data-template="language-list.html" data-container="body"><i class="icon-align-justify"></i> <span translate>LANGUAGE</span></a>
				</li>
				<li class="visible-xs">
					<a href="" data-animation="am-flip-x" bs-dropdown data-placement="bottom-left" data-template="language-list.html" data-container="body"><i class="icon-align-justify"></i> <span translate>LANGUAGE</span></a>
				</li>
			</ul>
		</div>
	</div>
</div>
<script type="text/ng-template" id="language-list.html">
	<ul class="dropdown-menu">
		<li><a href="" ng-click="changeLanguage('en')"><img src=<#static "img/flags/en.png"#>></img>&nbsp;<span translate>EN</span></a></li>
		<li><a href="" ng-click="changeLanguage('zh_CN')"><img src=<#static "img/flags/zhcn.png"#>></img>&nbsp;<span translate>ZH_CN</span></a></li>
	</ul>
</script>
<script type="text/ng-template" id="left-sample.html">
<div style="height:100%;overflow-y:auto">
<ul>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
<li>111212</li>
</ul>
</div>
</script>

<div class="container">
	<div class="row">
		<div class="col-sm-3 col-md-2 sidebar slide-animate" >
			<div class="leftContent" ng-include="'left-sample.html'">
			</div>
		</div>
		<div id="main" class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
<button type="button" class="btn btn-lg btn-primary" bs-aside data-content-template="left-sample.html" data-placement="left" data-animation="am-slide-left" data-container="body">Click to toggle aside
  <br>
  <small>(using an object)</small>
</button>

		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right	right
		</div>
	</div>

</div><!-- /.container -->
</div>
