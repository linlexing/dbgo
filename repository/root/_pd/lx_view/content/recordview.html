<#append . "OtherJSFiles" "/public/js/trNgGrid.js"#>
<#append . "OtherCSSFiles" "/public/css/trNgGrid.min.css"#>
<#append . "OtherDependencys" "trNgGrid"#>
<#template "ngheader.html" .#>
<link rel="stylesheet" type="text/css" href=<#static "recordview/show.css"#>></link>
<script>
app.config(['$translateProvider', function ($translateProvider) {
	$translateProvider.translations('en', {
		"LABEL": <#.label_en#>,
		"SEARCH":"Search"
	}).translations('cn', {
		"LABEL": <#.label_cn#>,
		"SEARCH":"搜索"
	}).registerAvailableLanguageKeys(['en', 'cn'], {
		'en_US': 'en',
		'en_UK': 'en',
		'zh_CN': 'cn',
		'zh_cn': 'cn'
	}).determinePreferredLanguage()
	.useLocalStorage();
}]);
app.controller('mainCtrl', ['$translate', '$scope','$alert','$http','$timeout',function ($translate, $scope,$alert,$http,$timeout) {
	$translate("LABEL").then(function(label){
		document.title=label;
	});
	$scope.pagesize = 100;
	$scope.time = 10.0;
	$scope.navCollapsed=true;
	$scope.data={columns:[],data:{},total:0};
	$scope.contentHeight = $(window).height()-51 + "px";
	$scope.contentWidth = $(window).width()+ "px";
	$(window).resize(function(){
		if($scope.navCollapsed){
		    $scope.$apply(function(){
				$scope.contentHeight = $(window).height()-51 + "px";
				$scope.contentWidth = $(window).width() + "px";
		    });
		}
	});
	$scope.scrollTop = 0;
	$(".content").scroll(function(event){
		$scope.$apply(function(){
			$scope.scrollTop =$(".content").scrollTop()+"px" ;
		});
	});
	$scope.refreshData= function(){
		$http.post(<#.data_action#>,{})
			.success(function(data,status,headers,config,statusText){
				//$scope.myData = $.parseJSON(JSON.parse(data.data));
				$scope.data.data = data.data;
				$scope.data.columns = data.columns;
			})
			.error(function(data,status,headers,config,statusText){
				$alert({title: 'error', content:data.error, placement: 'top-right', type: 'danger', show: true});
			});
	}
	$scope.refreshData();
}]);
</script>
<script type="text/ng-template" id="process.html">
<ul class="dropdown-menu">
	<li><a href="">test1</a></li>
	<li><a href="">test1</a></li>
	<li><a href="">test1</a></li>
	<li><a href="">test1</a></li>
</ul>
</script>
<script type="text/ng-template" id="privateTemplate.html">
<ul class="dropdown-menu">
	<li><a href="">test1</a></li>
	<li><a href="">test1</a></li>
	<li><a href="">test1</a></li>
	<li><a href="">test1</a></li>
</ul>
</script>

<div ng-controller="mainCtrl" style="height:100%">
<nav role="navigation" class="navbar navbar-default navbar-static-top">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
		<div class="navbar-brand navbar-left" data-animation="am-flip-x" bs-dropdown data-template="process.html" data-placement="bottom-left" data-container="body"><a href=""><i class="fa fa-th" ></i></a></div>
        <button type="button" ng-click="navCollapsed = !navCollapsed" class="navbar-toggle">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
    </div>
    <!-- Collection of nav links and other content for toggling -->
    <div class="collapse navbar-collapse"  ng-class="{'in':!navCollapsed}">
		<form class="navbar-form navbar-left" role="search">
				<select class="form-control">
				  <option>1</option>
				  <option>2</option>
				  <option>3</option>
				  <option>4</option>
				  <option>5</option>
				</select>
				<select class="form-control">
				  <option>等于</option>
				  <option>包含</option>
				  <option>3</option>
				  <option>4</option>
				  <option>5</option>
				</select>
				<input type="text" class="form-control" placeholder="Search">
				<button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>
		</form>
		<form class="navbar-form navbar-right" role="search">
			<div class="form-group">
				<label>模板(公):</label>
				<select class="form-control">
				  <option>1</option>
				  <option>2</option>
				  <option>3</option>
				  <option>4</option>
				  <option>5</option>
				</select>
				<a class="btn btn-default"><i class="fa fa-pencil-square-o"></i></a>
			</div>
			<div class="form-group">
				<label>私:</label>
				<select class="form-control">
				  <option>1</option>
				  <option>2</option>
				  <option>3</option>
				  <option>4</option>
				  <option>5</option>
				</select>
				<a class="btn btn-default"><i class="fa fa-pencil-square-o"></i></a>
			</div>
		</form>
    </div>
</nav>
<div class="content" style="height:{{contentHeight}};width:{{contentWidth}}">
	<table class="table table-striped table-bordered table-hover">
		<thead>
			<tr>
				<th ng-repeat="column in data.columns" style="top:{{scrollTop}}">
				{{column.fieldName}}
				</th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="item in data.data">
				<td ng-repeat="column in data.columns">
					{{item[column.fieldName]}}
				</td>
			</tr>
		</tbody>
	</table>
	<div class="footer">
		<form class="form-inline">
			total:{{data.total}},page num:{{data.total/pagesize}}
			<button class="form-control btn btn-default"><i class="fa fa-angle-left"></i></button>
			<input type=text class="form-control" style="width:50px"></input>
			<button class="form-control btn btn-default"><i class="fa fa-angle-right"></i></button>
			<span class="time">time:{{time}}</span>
		</form>
	</div>
</div>
<#template "ngfooter.html" .#>
